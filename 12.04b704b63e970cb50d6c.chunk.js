webpackJsonp([12],{"+1AZ":function(e,t,a){t=e.exports=a("rP7Y")(!1),t.push([e.i,".btn.btn-success.alineado{position:relative;left:50%;top:35%}.tile{margin:3% 4%;text-align:center;color:#fff;font-family:Segoe UI Light}.tile-yellow{background-color:#d2a800}.tile-orange{background-color:#e67300}.tile-lightbrown{background-color:#bc8f8f}.tile-darkbrown{background-color:#695747}.tile p{font-size:.85em}.tile label{font-size:3.25em;font-weight:700}",""]),e.exports=e.exports.toString()},"6TNo":function(e,t,a){"use strict";var s=a("/oeL"),i=a("K28T"),r=a("/lGx"),o=a("cpCA"),n=a("uLa+"),l=a("5O89");a.d(t,"a",function(){return c});var d=this&&this.__decorate||function(e,t,a,s){var i,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,s);else for(var n=e.length-1;n>=0;n--)(i=e[n])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o},h=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},c=function(){function e(e,t){this.apiService=e,this.dateService=t,this.modelIntervalo="",this.disableAnos=!0,this.disableMes=!0,this.disableHoras=!0,this.disableDias=!0,this.disableSemanas=!0,this.promedioHora="-",this.promedioDia="-",this.promedioSemana="-",this.promedioMes="-",this.linearChartDataAux=[0,0,0],this.lineChartData=[{data:this.linearChartDataAux,label:"Ingresos"}],this.chartLabels=[],this.lineChartLabels=["*","*"],this.lineChartOptions={responsive:!0},this.lineChartColors=[{backgroundColor:"rgba(154, 247, 150, 0.4)",borderColor:"rgba(77,83,96, 0.7)",pointBackgroundColor:"rgba(77,83,96,1)",pointBorderColor:"#4f79af",pointHoverBackgroundColor:"#44a354",pointHoverBorderColor:"rgba(77,83,96,1)"}],this.lineChartLegend=!0,this.lineChartType="line",this.today=new Date,this.showAlert=!1}return e.prototype.ngOnInit=function(){this.myDatePickerOptionsDesde={dateFormat:"dd/mm/yyyy",dayLabels:{su:"Dom",mo:"Lun",tu:"Mar",we:"Mié",th:"Jue",fr:"Vie",sa:"Sáb"},monthLabels:{1:"Ene",2:"Feb",3:"Mar",4:"Abr",5:"May",6:"Jun",7:"Jul",8:"Ago",9:"Sep",10:"Oct",11:"Nov",12:"Dic"},todayBtnTxt:"Hoy",showClearDateBtn:!0,editableDateField:!1,openSelectorOnInputClick:!0,alignSelectorRight:!1};var e=JSON.parse(JSON.stringify(this.myDatePickerOptionsDesde)),t=new Date(this.today.getTime()+864e5);console.log(t),e.disableSince={year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()},console.log(e),this.myDatePickerOptionsDesde=e,this.myDatePickerOptionsHasta=e},e.prototype.chartHovered=function(e){},e.prototype.chartClicked=function(e){},e.prototype.onChangeDesde=function(e){var t=JSON.parse(JSON.stringify(this.myDatePickerOptionsHasta));this.modelDesde=e;var a=new Date(1e3*this.modelDesde.epoc-864e5);t.disableUntil={year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate()},this.myDatePickerOptionsHasta=t,this.modelHasta&&(this.difDays=this.dateService.dateDif(this.modelDesde,this.modelHasta),this.setSelect(this.difDays))},e.prototype.onChangeHasta=function(e){this.modelHasta=e,this.difDays=this.dateService.dateDif(this.modelDesde,this.modelHasta),this.setSelect(this.difDays)},e.prototype.onSelectClick=function(e){this.difDays=this.dateService.dateDif(this.modelDesde,this.modelHasta),this.setSelect(this.difDays),this.modelDesde||this.modelHasta?this.showAlert=!1:this.showAlert=!0},e.prototype.onGenerateClick=function(){var e=this,t=("0"+this.modelDesde.date.day).slice(-2)+"/"+("0"+this.modelDesde.date.month).slice(-2)+"/"+this.modelDesde.date.year+" 00:00:00",a=("0"+this.modelHasta.date.day).slice(-2)+"/"+("0"+this.modelHasta.date.month).slice(-2)+"/"+this.modelHasta.date.year+" 00:00:00",s=new r.a,i=new o.a;s.fechaFinal=a,s.fechaInicial=t,i=JSON.parse(localStorage.getItem("currentParking")),s.idEstacionamiento=i.idEstacionamiento,this.apiService.post("ingreso/ingresoVehiculo/allByFechas",s).subscribe(function(t){e.ingresos=t,e.generateChar(),e.generateAverages()})},e.prototype.setSelect=function(e){e<32&&e>7?(this.disableHoras=!0,this.disableDias=!1,this.modelIntervalo="Dias",this.disableSemanas=!0,this.disableMes=!0):e>32&&e<128?(this.disableHoras=!0,this.disableDias=!0,this.disableSemanas=!1,this.modelIntervalo="Semanas",this.disableMes=!1):e>128?(this.disableMes=!1,this.modelIntervalo="Mes",this.disableHoras=!0,this.disableDias=!0,this.disableSemanas=!0):(this.disableHoras=!1,this.modelIntervalo="Horas",this.disableDias=!0,this.disableSemanas=!0,this.disableMes=!0)},e.prototype.generateChar=function(){"Horas"===this.modelIntervalo?this.graficoHoras():"Dias"===this.modelIntervalo?this.graficoDias():"Semanas"===this.modelIntervalo?this.graficoSem():"Mes"===this.modelIntervalo&&this.graficoMeses()},e.prototype.generateAverages=function(){var e=this.dateService.diffHours(this.modelDesde,this.modelHasta),t=this.dateService.diffDays(this.modelDesde,this.modelHasta),a=this.dateService.diffWeeks(this.modelDesde,this.modelHasta),s=this.dateService.diffMonths(this.modelDesde,this.modelHasta);this.promedioHora=(this.ingresos.length/e).toFixed(2),this.promedioDia=t<3?"-":(this.ingresos.length/t).toFixed(2),this.promedioSemana=a<1?"-":Math.round(this.ingresos.length/a).toString(),this.promedioMes=s<1?"-":Math.round(this.ingresos.length/s).toString()},e.prototype.arrayGenerator=function(e,t,a){for(var s=0;s<e;s++)"string"===t&&(a[s]?a[s]="-":a.push("+")),"number"===t&&(a[s]?a[s]=0:a.push(0));return a.length>e&&a.splice(e,a.length-e+1),a},e.prototype.graficoSem=function(){for(var e=this.arrayGenerator(this.difDays/7,"number",this.linearChartDataAux),t=this.arrayGenerator(this.difDays/7,"string",this.lineChartLabels),a=0,s=this.ingresos;a<s.length;a++){var i=s[a];console.log(new Date(i.fechaIngreso).getDay());e[+i.fechaIngreso.substr(0,10).slice(-2)]++}this.lineChartData=[{data:this.linearChartDataAux,label:"Ingresos"}],this.chartLabelsGenerator("Sem",1,t),this.lineChartLabels=t},e.prototype.graficoMeses=function(){},e.prototype.graficoDias=function(){for(var e=(this.arrayGenerator(this.difDays,"number",this.linearChartDataAux),this.arrayGenerator(this.difDays,"string",this.lineChartLabels)),t=0,a=this.ingresos;t<a.length;t++){var s=a[t],i=+s.fechaIngreso.substr(0,10).slice(-2);i-=+this.modelDesde.date.day,this.linearChartDataAux[i]++}this.lineChartData=[{data:this.linearChartDataAux,label:"Ingresos"}],this.chartLabelsGenerator("Dias",1,e),this.lineChartLabels=e},e.prototype.graficoHoras=function(){var e=this,t=1;this.difDays<4&&this.difDays>1?t=2:this.difDays<6&&this.difDays>3?t=4:this.difDays<8&&this.difDays>5&&(t=8);var a=new Map;this.ingresos.forEach(function(e){var s=e.fechaIngreso.slice(0,11),i=+e.fechaIngreso.slice(11,13)-+e.fechaIngreso.slice(11,13)%t,r=("0"+i).slice(-2)+":00";null==a.get(s+r)?a.set(s+r,0):a.set(s+r,a.get(s+r)+1)});var s=[];this.lineChartLabels.splice(0),a.forEach(function(t,a){e.lineChartLabels.push(a)}),this.lineChartLabels.sort(),this.lineChartLabels.forEach(function(e){s.push(a.get(e))});for(var i=0;i<this.lineChartLabels.length;i++){if(0===+this.lineChartLabels[i].slice(11,13)){var r=this.lineChartLabels[i].slice(5,7),o=this.lineChartLabels[i].slice(8,10),n=this.lineChartLabels[i].slice(11,13);this.lineChartLabels[i]=o+"/"+r+" "+n+":00"}else this.lineChartLabels[i]=this.lineChartLabels[i].slice(11,13)+":00"}this.lineChartData=[{data:s,label:"Ingresos"}]},e.prototype.chartLabelsGenerator=function(e,t,a){switch(e){case"Horas":for(var s=0,i=0;i<a.length;i++)a[i]=("0"+s).slice(-2)+":00",(s+=t)>=24&&(s=0);break;case"Dias":for(var r=this.modelDesde.date.day,o=this.modelDesde.date.month,i=0;i<a.length;i++){a[i]=r+"/"+o;var n=1e3*this.modelDesde.epoc+864e5*(i+1);r=new Date(n).getDate(),o=new Date(n).getMonth()+1}break;case"Sem":for(var l=0,i=0;i<a.length;i++)a[i]="Sem. "+l,l+=t;break;case"Mes":for(var d=this.modelDesde.date.year,o=this.modelDesde.date.month,i=0;i<a.length;i++){a[i]=o+"/"+d;var n=1e3*this.modelDesde.epoc+864e5*(i+1);d=new Date(n).getFullYear(),o=new Date(n).getMonth()+1}}return a},e}();c=d([a.i(s.Component)({selector:"app-reporte-1",template:a("asSV"),styles:[a("+1AZ")],animations:[a.i(l.a)()]}),h("design:paramtypes",["function"==typeof(p=void 0!==i.a&&i.a)&&p||Object,"function"==typeof(f=void 0!==n.a&&n.a)&&f||Object])],c);var p,f},"96DN":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("/oeL"),i=a("qbdv"),r=a("UhLR"),o=(a.n(r),a("gOac")),n=a("6TNo"),l=a("WxWp"),d=a("bm2B"),h=a("0WLp"),c=a("jJff");a.d(t,"Reporte1Module",function(){return f});var p=this&&this.__decorate||function(e,t,a,s){var i,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,s);else for(var n=e.length-1;n>=0;n--)(i=e[n])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o},f=function(){function e(){}return e}();f=p([a.i(s.NgModule)({imports:[i.k,d.a,d.b,h.a.forRoot(),c.MyDatePickerModule,r.ChartsModule,l.a,o.b],declarations:[n.a]})],f)},WxWp:function(e,t,a){"use strict";var s=a("/oeL"),i=a("BkNc"),r=a("6TNo");a.d(t,"a",function(){return l});var o=this&&this.__decorate||function(e,t,a,s){var i,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,s);else for(var n=e.length-1;n>=0;n--)(i=e[n])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o},n=[{path:"",component:r.a}],l=function(){function e(){}return e}();l=o([a.i(s.NgModule)({imports:[i.a.forChild(n)],exports:[i.a]})],l)},asSV:function(e,t){e.exports='<app-page-header [heading]="\'Reporte estadístico de ingresos\'" [icon]="\'fa-pie-chart\'"></app-page-header>\r\n\r\n<div [@routerTransition]>\r\n    <div class="row">\r\n        <div class="col-md-12">\r\n            <h2>Reporte estadístico de Ingresos</h2>\r\n            <hr>\r\n            <br>\r\n        </div>\r\n    </div>\r\n    <div class="row">\r\n        <div class="col-md-3">\r\n            <label class="control-label">Desde</label>\r\n            <form class="form-inline mb-3">\r\n                <my-date-picker name="mydateDesde" [(ngModel)]="modelDesde" [options]="myDatePickerOptionsDesde"\r\n                                 (dateChanged) ="onChangeDesde($event)" required></my-date-picker>\r\n            </form>\r\n        </div>\r\n        <div class="col-md-3">\r\n            <label class="control-label">Hasta</label>\r\n            <form class="form-inline mb-3">\r\n                <my-date-picker name="mydateHasta" [(ngModel)]="modelHasta" [options]="myDatePickerOptionsHasta"\r\n                                 (dateChanged) ="onChangeHasta($event)"\r\n                                 required></my-date-picker>\r\n            </form>\r\n        </div>\r\n        <div class="col-md-2">\r\n            <label class="control-label">Intervalo</label>\r\n            <div class="form-group">\r\n                <select [(ngModel)]="modelIntervalo" class="form-control" (click)="onSelectClick($event.target.value)">\r\n                    <option [disabled]="disableHoras" class="active">Horas</option>\r\n                    <option [disabled]="disableDias" >Dias</option>\r\n                    <option [disabled]="disableSemanas" >Semanas</option>\r\n                    <option [disabled]="disableMes" >Meses</option>\r\n                    <option [disabled]="disableAnos" >Años</option>\r\n                </select>\r\n            </div>\r\n        </div>\r\n        <div class="col-md-2">\r\n            <button (click)="onGenerateClick()" class="btn btn-success alineado" >Generar Grafico</button>\r\n        </div>\r\n        <br>\r\n        <br>\r\n    </div>\r\n    <ngb-alert class="alert-warning" (close)="showAlert = false" *ngIf="showAlert" >\r\n        <strong>Datos incompletos.</strong> Por favor seleccione un rango de fechas.\r\n    </ngb-alert>\r\n    <div class="row">\r\n        <div class="col col-md-8">\r\n            <div class="card mb-3">\r\n                <div class="card-header">Vehículos ingresados</div>\r\n                <div class="card-block">\r\n                    <canvas baseChart height="130" [datasets]="lineChartData"\r\n                            [labels]="lineChartLabels" [options]="lineChartOptions"\r\n                            [colors]="lineChartColors" [legend]="lineChartLegend"\r\n                            [chartType]="lineChartType"\r\n                            (chartHover)="chartHovered($event)"\r\n                            (chartClick)="chartClicked($event)">\r\n                    </canvas>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="col col-md-4">\r\n            <div class="card mb-3">\r\n                <div class="card-header">\r\n                    Ingresos promedio de vehículos\r\n                </div>\r\n                <div class="card-block">\r\n                    <div class="row">\r\n                        <div class="tile tile-yellow col-md-5">\r\n                            <label>{{promedioHora}}</label>\r\n                            <p>Ingresos por hora</p>\r\n                        </div>\r\n                        <div class="tile tile-orange col-md-5">\r\n                            <label>{{promedioDia}}</label>\r\n                            <p>Ingresos por día</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="row">\r\n                        <div class="tile tile-lightbrown col-md-5">\r\n                            <label>{{promedioSemana}}</label>\r\n                            <p>Ingresos por semana</p>\r\n                        </div>\r\n                        <div class="tile tile-darkbrown col-md-5">\r\n                            <label>{{promedioMes}}</label>\r\n                            <p>Ingresos por mes</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}});