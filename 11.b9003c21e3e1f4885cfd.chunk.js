webpackJsonp([11],{"2hJB":function(e,t,a){"use strict";var s=a("/oeL"),i=a("5O89"),n=a("K28T"),o=a("uLa+");a.d(t,"a",function(){return d});var r=this&&this.__decorate||function(e,t,a,s){var i,n=arguments.length,o=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(o=(n<3?i(o):n>3?i(t,a,o):i(t,a))||o);return n>3&&o&&Object.defineProperty(t,a,o),o},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},d=function(){function e(e,t){this.apiService=e,this.dateService=t,this.showLoading=!1,this.modelIntervalo="",this.disableAnos=!0,this.disableMes=!0,this.disableHoras=!0,this.disableDias=!0,this.disableSemanas=!0,this.reservas=[],this.today=new Date,this.showAlert=!1,this.totalReservas=0,this.porcentajeAceptadas="-",this.porcentajeExpiradas="-",this.porcentajeCanceladas="-",this.pieChartLabels=["Reservas expiradas","Reservas Confirmadas","Reservas Canceladas"],this.pieChartData=[0,0,0],this.pieChartType="pie"}return e.prototype.ngOnInit=function(){this.myDatePickerOptionsDesde={dateFormat:"dd/mm/yyyy",dayLabels:{su:"Dom",mo:"Lun",tu:"Mar",we:"Mié",th:"Jue",fr:"Vie",sa:"Sáb"},monthLabels:{1:"Ene",2:"Feb",3:"Mar",4:"Abr",5:"May",6:"Jun",7:"Jul",8:"Ago",9:"Sep",10:"Oct",11:"Nov",12:"Dic"},todayBtnTxt:"Hoy",showClearDateBtn:!0,editableDateField:!1,openSelectorOnInputClick:!0,alignSelectorRight:!1};var e=JSON.parse(JSON.stringify(this.myDatePickerOptionsDesde)),t=new Date(this.today.getTime()+864e5);e.disableSince={year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()},this.myDatePickerOptionsDesde=e,this.myDatePickerOptionsHasta=e},e.prototype.chartHovered=function(e){},e.prototype.chartClicked=function(e){},e.prototype.onChangeDesde=function(e){var t=JSON.parse(JSON.stringify(this.myDatePickerOptionsHasta));this.modelDesde=e;var a=new Date(1e3*this.modelDesde.epoc-864e5);t.disableUntil={year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate()},this.myDatePickerOptionsHasta=t,this.modelHasta&&(this.difDays=this.dateService.dateDif(this.modelDesde,this.modelHasta),this.setSelect(this.difDays))},e.prototype.onChangeHasta=function(e){this.modelHasta=e,this.difDays=this.dateService.dateDif(this.modelDesde,this.modelHasta),this.setSelect(this.difDays)},e.prototype.onSelectClick=function(e){this.difDays=this.dateService.dateDif(this.modelDesde,this.modelHasta),this.setSelect(this.difDays),this.modelDesde||this.modelHasta?this.showAlert=!1:this.showAlert=!0},e.prototype.onGenerateClick=function(){var e=this,t=this.modelDesde.date.year+"-"+("0"+this.modelDesde.date.month).slice(-2)+"-"+("0"+this.modelDesde.date.day).slice(-2),a=this.modelHasta.date.year+"-"+("0"+this.modelHasta.date.month).slice(-2)+"-"+("0"+this.modelHasta.date.day).slice(-2),s=JSON.parse(localStorage.getItem("currentParking"));this.showLoading=!0,this.apiService.get("/reserva/all/parque/"+s.idEstacionamiento).subscribe(function(s){e.reservas=s,e.generateChar(t,a)})},e.prototype.setSelect=function(e){e<32&&e>7?(this.disableHoras=!0,this.disableDias=!1,this.modelIntervalo="Dias",this.disableSemanas=!0,this.disableMes=!0):e>32&&e<128?(this.disableHoras=!0,this.disableDias=!0,this.disableSemanas=!1,this.modelIntervalo="Semanas",this.disableMes=!1):e>128?(this.disableMes=!1,this.modelIntervalo="Mes",this.disableHoras=!0,this.disableDias=!0,this.disableSemanas=!0):(this.disableHoras=!1,this.modelIntervalo="Horas",this.disableDias=!0,this.disableSemanas=!0,this.disableMes=!0)},e.prototype.generateChar=function(e,t){var a=this,s=0,i=0,n=0;this.reservas.forEach(function(a){a.horaCreacionReserva.slice(0,10).localeCompare(e)>=0&&a.horaCreacionReserva.slice(0,10).localeCompare(t)<=0&&(a.cancelada&&i++,a.confirmada&&s++,a.expirada&&n++)});var o=[];o.push(n),o.push(s),o.push(i),this.pieChartData=o,this.totalReservas=0,this.pieChartData.forEach(function(e){return a.totalReservas+=e}),this.porcentajeCanceladas=Math.round(this.pieChartData[2]/this.totalReservas*100).toString(),this.porcentajeAceptadas=Math.round(this.pieChartData[1]/this.totalReservas*100).toString(),this.porcentajeExpiradas=Math.round(this.pieChartData[0]/this.totalReservas*100).toString(),this.showLoading=!1},e}();d=r([a.i(s.Component)({selector:"app-reporte-3",template:a("D82r"),styles:[a("Ngp8")],animations:[a.i(i.a)()]}),l("design:paramtypes",["function"==typeof(c=void 0!==n.a&&n.a)&&c||Object,"function"==typeof(h=void 0!==o.a&&o.a)&&h||Object])],d);var c,h},D82r:function(e,t){e.exports='<app-page-header [heading]="\'Reporte estadístico de reservas\'" [icon]="\'fa-pie-chart\'"></app-page-header>\n\n<div [@routerTransition]>\n    <div class="row">\n        <div class="col-md-12">\n            <h2>Reporte estadístico de Reservas</h2>\n            <hr>\n            <br>\n        </div>\n    </div>\n    <div class="card" *ngIf="showLoading">\n        <div class="card-block">\n            <div style="text-align: center">\n                <div class="loader"></div>\n                <p>Cargando reservas..</p>\n            </div>\n        </div>\n    </div>\n    <div *ngIf="!showLoading">\n        <div class="row">\n            <div class="col-md-3">\n                <label class="control-label">Desde</label>\n                <form class="form-inline mb-3">\n                    <my-date-picker name="mydateDesde" [(ngModel)]="modelDesde" [options]="myDatePickerOptionsDesde"\n                                    (dateChanged) ="onChangeDesde($event)" required></my-date-picker>\n                </form>\n            </div>\n            <div class="col-md-3">\n                <label class="control-label">Hasta</label>\n                <form class="form-inline mb-3">\n                    <my-date-picker name="mydateHasta" [(ngModel)]="modelHasta" [options]="myDatePickerOptionsHasta"\n                                    (dateChanged) ="onChangeHasta($event)"\n                                    required></my-date-picker>\n                </form>\n            </div>\n            <div class="col-md-2">\n                <label class="control-label">Intervalo</label>\n                <div class="form-group">\n                    <select [(ngModel)]="modelIntervalo" class="form-control" (click)="onSelectClick($event.target.value)">\n                        <option [disabled]="disableHoras" class="active">Horas</option>\n                        <option [disabled]="disableDias" >Dias</option>\n                        <option [disabled]="disableSemanas" >Semanas</option>\n                        <option [disabled]="disableMes" >Meses</option>\n                        <option [disabled]="disableAnos" >Años</option>\n                    </select>\n                </div>\n            </div>\n            <div class="col-md-2">\n                <button (click)="onGenerateClick()" class="btn btn-success alineado" >Generar gráfico</button>\n            </div>\n            <br>\n            <br>\n        </div>\n        <ngb-alert class="alert-warning" (close)="showAlert = false" *ngIf="showAlert" >\n            <strong>Datos incompletos.</strong> Por favor seleccione un rango de fechas.\n        </ngb-alert>\n\n        <div class="row">\n            <div class="col col-md-8">\n                <div class="card mb-3">\n                    <div class="card-header">Reservas según su tipo</div>\n                    <div class="card-block">\n                        <canvas baseChart height="130px"\n                                [data]="pieChartData"\n                                [labels]="pieChartLabels"\n                                [chartType]="pieChartType"\n                                (chartHover)="chartHovered($event)"\n                                (chartClick)="chartClicked($event)">\n                        </canvas>\n                    </div>\n                </div>\n            </div>\n            <div class="col col-md-4">\n                <div class="card mb-3">\n                    <div class="card-header">\n                        Estadísticas porcentuales\n                    </div>\n                    <div class="card-block">\n                        <div class="row">\n                            <div class="tile tile-green col-md-5">\n                                <label>{{totalReservas}}</label>\n                                <p>Reservas en total</p>\n                            </div>\n                            <div class="tile tile-blue col-md-5">\n                                <label>{{porcentajeAceptadas}}%</label>\n                                <p>Aceptadas</p>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="tile tile-orange col-md-5">\n                                <label>{{porcentajeExpiradas}}%</label>\n                                <p>Expiradas</p>\n                            </div>\n                            <div class="tile tile-yellow col-md-5">\n                                <label>{{porcentajeCanceladas}}%</label>\n                                <p>Canceladas</p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'},Ngp8:function(e,t,a){t=e.exports=a("rP7Y")(!1),t.push([e.i,"@media screen and (min-width:768px){.btn.btn-success.alineado{position:relative;left:50%;top:35%}}@media screen and (max-width:767px) and (min-width:401px){.btn.btn-success.alineado{position:relative;left:35%}}@media screen and (max-width:400px) and (min-width:0px){.btn.btn-success.alineado{position:relative;left:25%}}.tile{margin:3% 4%;text-align:center;color:#fff;font-family:Segoe UI Light;font-weight:700}.tile-yellow{background-color:rgba(225,200,0,.6)}.tile-orange{background-color:rgba(255,0,0,.4)}.tile-blue{background-color:rgba(0,119,255,.6)}.tile-green{background-color:rgba(0,132,9,.6)}.tile label{font-size:3.25em}.loader{position:relative;left:40%;top:50%;border:16px solid #f3f3f3;border-top:16px solid #3498db;border-radius:50%;width:120px;height:120px;-webkit-animation:spin 2s linear infinite;animation:spin 2s linear infinite}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}",""]),e.exports=e.exports.toString()},TMQN:function(e,t,a){"use strict";var s=a("/oeL"),i=a("BkNc"),n=a("2hJB");a.d(t,"a",function(){return l});var o=this&&this.__decorate||function(e,t,a,s){var i,n=arguments.length,o=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(o=(n<3?i(o):n>3?i(t,a,o):i(t,a))||o);return n>3&&o&&Object.defineProperty(t,a,o),o},r=[{path:"",component:n.a}],l=function(){function e(){}return e}();l=o([a.i(s.NgModule)({imports:[i.a.forChild(r)],exports:[i.a]})],l)},oD9F:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("/oeL"),i=a("qbdv"),n=a("UhLR"),o=(a.n(n),a("gOac")),r=a("TMQN"),l=a("2hJB"),d=a("bm2B"),c=a("0WLp"),h=a("jJff");a.d(t,"Reporte3Module",function(){return v});var p=this&&this.__decorate||function(e,t,a,s){var i,n=arguments.length,o=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(o=(n<3?i(o):n>3?i(t,a,o):i(t,a))||o);return n>3&&o&&Object.defineProperty(t,a,o),o},v=function(){function e(){}return e}();v=p([a.i(s.NgModule)({imports:[i.k,n.ChartsModule,r.a,o.b,d.a,d.b,c.a.forRoot(),h.MyDatePickerModule],declarations:[l.a]})],v)}});