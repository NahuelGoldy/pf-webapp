webpackJsonp([11],{"2hJB":function(e,t,a){"use strict";var r=a("/oeL"),s=a("5O89"),i=a("K28T"),n=a("uLa+");a.d(t,"a",function(){return d});var o=this&&this.__decorate||function(e,t,a,r){var s,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,a,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(n=(i<3?s(n):i>3?s(t,a,n):s(t,a))||n);return i>3&&n&&Object.defineProperty(t,a,n),n},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},d=function(){function e(e,t){this.apiService=e,this.dateService=t,this.showLoading=!1,this.modelIntervalo="",this.disableAnos=!0,this.disableMes=!0,this.disableHoras=!0,this.disableDias=!0,this.disableSemanas=!0,this.reservas=[],this.today=new Date,this.showAlert=!1,this.totalReservas=0,this.porcentajeAceptadas="-",this.porcentajeExpiradas="-",this.porcentajeCanceladas="-",this.pieChartLabels=["Reservas expiradas","Reservas Confirmadas","Reservas Canceladas"],this.pieChartData=[0,0,0],this.pieChartType="pie"}return e.prototype.ngOnInit=function(){this.myDatePickerOptionsDesde={dateFormat:"dd/mm/yyyy",dayLabels:{su:"Dom",mo:"Lun",tu:"Mar",we:"Mié",th:"Jue",fr:"Vie",sa:"Sáb"},monthLabels:{1:"Ene",2:"Feb",3:"Mar",4:"Abr",5:"May",6:"Jun",7:"Jul",8:"Ago",9:"Sep",10:"Oct",11:"Nov",12:"Dic"},todayBtnTxt:"Hoy",showClearDateBtn:!0,editableDateField:!1,openSelectorOnInputClick:!0,alignSelectorRight:!1};var e=JSON.parse(JSON.stringify(this.myDatePickerOptionsDesde)),t=new Date(this.today.getTime()+864e5);e.disableSince={year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()},this.myDatePickerOptionsDesde=e,this.myDatePickerOptionsHasta=e},e.prototype.chartHovered=function(e){},e.prototype.chartClicked=function(e){},e.prototype.onChangeDesde=function(e){var t=JSON.parse(JSON.stringify(this.myDatePickerOptionsHasta));this.modelDesde=e;var a=new Date(1e3*this.modelDesde.epoc-864e5);t.disableUntil={year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate()},this.myDatePickerOptionsHasta=t,this.modelHasta&&(this.difDays=this.dateService.dateDif(this.modelDesde,this.modelHasta),this.setSelect(this.difDays))},e.prototype.onChangeHasta=function(e){this.modelHasta=e,this.difDays=this.dateService.dateDif(this.modelDesde,this.modelHasta),this.setSelect(this.difDays)},e.prototype.onSelectClick=function(e){this.difDays=this.dateService.dateDif(this.modelDesde,this.modelHasta),this.setSelect(this.difDays),this.modelDesde||this.modelHasta?this.showAlert=!1:this.showAlert=!0},e.prototype.onGenerateClick=function(){var e=this,t=this.modelDesde.date.year+"-"+("0"+this.modelDesde.date.month).slice(-2)+"-"+("0"+this.modelDesde.date.day).slice(-2),a=this.modelHasta.date.year+"-"+("0"+this.modelHasta.date.month).slice(-2)+"-"+("0"+this.modelHasta.date.day).slice(-2),r=JSON.parse(localStorage.getItem("currentParking"));this.showLoading=!0,this.apiService.get("/reserva/all/parque/"+r.idEstacionamiento).subscribe(function(r){e.reservas=r,e.generateChar(t,a)})},e.prototype.setSelect=function(e){e<32&&e>7?(this.disableHoras=!0,this.disableDias=!1,this.modelIntervalo="Dias",this.disableSemanas=!0,this.disableMes=!0):e>32&&e<128?(this.disableHoras=!0,this.disableDias=!0,this.disableSemanas=!1,this.modelIntervalo="Semanas",this.disableMes=!1):e>128?(this.disableMes=!1,this.modelIntervalo="Mes",this.disableHoras=!0,this.disableDias=!0,this.disableSemanas=!0):(this.disableHoras=!1,this.modelIntervalo="Horas",this.disableDias=!0,this.disableSemanas=!0,this.disableMes=!0)},e.prototype.generateChar=function(e,t){var a=this,r=0,s=0,i=0;this.reservas.forEach(function(a){a.horaCreacionReserva.slice(0,10).localeCompare(e)>=0&&a.horaCreacionReserva.slice(0,10).localeCompare(t)<=0&&(a.cancelada&&s++,a.confirmada&&r++,a.expirada&&i++)});var n=[];n.push(i),n.push(r),n.push(s),this.pieChartData=n,this.totalReservas=0,this.pieChartData.forEach(function(e){return a.totalReservas+=e}),this.porcentajeCanceladas=Math.round(this.pieChartData[2]/this.totalReservas*100).toString(),this.porcentajeAceptadas=Math.round(this.pieChartData[1]/this.totalReservas*100).toString(),this.porcentajeExpiradas=Math.round(this.pieChartData[0]/this.totalReservas*100).toString(),this.showLoading=!1},e}();d=o([a.i(r.Component)({selector:"app-reporte-3",template:a("D82r"),styles:[a("Ngp8")],animations:[a.i(s.a)()]}),l("design:paramtypes",["function"==typeof(c=void 0!==i.a&&i.a)&&c||Object,"function"==typeof(h=void 0!==n.a&&n.a)&&h||Object])],d);var c,h},D82r:function(e,t){e.exports='<app-page-header [heading]="\'Reporte estadístico de reservas\'" [icon]="\'fa-pie-chart\'"></app-page-header>\r\n\r\n<div [@routerTransition]>\r\n    <div class="row">\r\n        <div class="col-md-12">\r\n            <h2>Reporte estadístico de Reservas</h2>\r\n            <hr>\r\n            <br>\r\n        </div>\r\n    </div>\r\n    <div class="card" *ngIf="showLoading">\r\n        <div class="card-block">\r\n            <div style="text-align: center">\r\n                <div class="loader"></div>\r\n                <p>Cargando reservas..</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div *ngIf="!showLoading">\r\n        <div class="row">\r\n            <div class="col-md-3">\r\n                <label class="control-label">Desde</label>\r\n                <form class="form-inline mb-3">\r\n                    <my-date-picker name="mydateDesde" [(ngModel)]="modelDesde" [options]="myDatePickerOptionsDesde"\r\n                                    (dateChanged) ="onChangeDesde($event)" required></my-date-picker>\r\n                </form>\r\n            </div>\r\n            <div class="col-md-3">\r\n                <label class="control-label">Hasta</label>\r\n                <form class="form-inline mb-3">\r\n                    <my-date-picker name="mydateHasta" [(ngModel)]="modelHasta" [options]="myDatePickerOptionsHasta"\r\n                                    (dateChanged) ="onChangeHasta($event)"\r\n                                    required></my-date-picker>\r\n                </form>\r\n            </div>\r\n            <div class="col-md-2">\r\n                <label class="control-label">Intervalo</label>\r\n                <div class="form-group">\r\n                    <select [(ngModel)]="modelIntervalo" class="form-control" (click)="onSelectClick($event.target.value)">\r\n                        <option [disabled]="disableHoras" class="active">Horas</option>\r\n                        <option [disabled]="disableDias" >Dias</option>\r\n                        <option [disabled]="disableSemanas" >Semanas</option>\r\n                        <option [disabled]="disableMes" >Meses</option>\r\n                        <option [disabled]="disableAnos" >Años</option>\r\n                    </select>\r\n                </div>\r\n            </div>\r\n            <div class="col-md-2">\r\n                <button (click)="onGenerateClick()" class="btn btn-success alineado" >Generar gráfico</button>\r\n            </div>\r\n            <br>\r\n            <br>\r\n        </div>\r\n        <ngb-alert class="alert-warning" (close)="showAlert = false" *ngIf="showAlert" >\r\n            <strong>Datos incompletos.</strong> Por favor seleccione un rango de fechas.\r\n        </ngb-alert>\r\n\r\n        <div class="row">\r\n            <div class="col col-md-8">\r\n                <div class="card mb-3">\r\n                    <div class="card-header">Reservas según su tipo</div>\r\n                    <div class="card-block">\r\n                        <canvas baseChart height="130px"\r\n                                [data]="pieChartData"\r\n                                [labels]="pieChartLabels"\r\n                                [chartType]="pieChartType"\r\n                                (chartHover)="chartHovered($event)"\r\n                                (chartClick)="chartClicked($event)">\r\n                        </canvas>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="col col-md-4">\r\n                <div class="card mb-3">\r\n                    <div class="card-header">\r\n                        Estadísticas porcentuales\r\n                    </div>\r\n                    <div class="card-block">\r\n                        <div class="row">\r\n                            <div class="tile tile-green col-md-5">\r\n                                <label>{{totalReservas}}</label>\r\n                                <p>Reservas en total</p>\r\n                            </div>\r\n                            <div class="tile tile-blue col-md-5">\r\n                                <label>{{porcentajeAceptadas}}%</label>\r\n                                <p>Aceptadas</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class="row">\r\n                            <div class="tile tile-orange col-md-5">\r\n                                <label>{{porcentajeExpiradas}}%</label>\r\n                                <p>Expiradas</p>\r\n                            </div>\r\n                            <div class="tile tile-yellow col-md-5">\r\n                                <label>{{porcentajeCanceladas}}%</label>\r\n                                <p>Canceladas</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},Ngp8:function(e,t,a){t=e.exports=a("rP7Y")(!1),t.push([e.i,"@media screen and (min-width:768px){.btn.btn-success.alineado{position:relative;left:50%;top:35%}}@media screen and (max-width:767px) and (min-width:401px){.btn.btn-success.alineado{position:relative;left:35%}}@media screen and (max-width:400px) and (min-width:0px){.btn.btn-success.alineado{position:relative;left:25%}}.tile{margin:3% 4%;text-align:center;color:#fff;font-family:Segoe UI Light;font-weight:700}.tile-yellow{background-color:rgba(225,200,0,.6)}.tile-orange{background-color:rgba(255,0,0,.4)}.tile-blue{background-color:rgba(0,119,255,.6)}.tile-green{background-color:rgba(0,132,9,.6)}.tile label{font-size:3.25em}.loader{position:relative;left:40%;top:50%;border:16px solid #f3f3f3;border-top:16px solid #3498db;border-radius:50%;width:120px;height:120px;-webkit-animation:spin 2s linear infinite;animation:spin 2s linear infinite}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}",""]),e.exports=e.exports.toString()},TMQN:function(e,t,a){"use strict";var r=a("/oeL"),s=a("BkNc"),i=a("2hJB");a.d(t,"a",function(){return l});var n=this&&this.__decorate||function(e,t,a,r){var s,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,a,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(n=(i<3?s(n):i>3?s(t,a,n):s(t,a))||n);return i>3&&n&&Object.defineProperty(t,a,n),n},o=[{path:"",component:i.a}],l=function(){function e(){}return e}();l=n([a.i(r.NgModule)({imports:[s.a.forChild(o)],exports:[s.a]})],l)},oD9F:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("/oeL"),s=a("qbdv"),i=a("UhLR"),n=(a.n(i),a("gOac")),o=a("TMQN"),l=a("2hJB"),d=a("bm2B"),c=a("0WLp"),h=a("jJff");a.d(t,"Reporte3Module",function(){return v});var p=this&&this.__decorate||function(e,t,a,r){var s,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,a,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(n=(i<3?s(n):i>3?s(t,a,n):s(t,a))||n);return i>3&&n&&Object.defineProperty(t,a,n),n},v=function(){function e(){}return e}();v=p([a.i(r.NgModule)({imports:[s.k,i.ChartsModule,o.a,n.b,d.a,d.b,c.a.forRoot(),h.MyDatePickerModule],declarations:[l.a]})],v)}});